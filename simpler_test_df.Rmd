---
title: "Test"
output: rmarkdown::md_document
editor_options: 
  chunk_output_type: console
---

``` {r setup, include = FALSE}
library(nycflights13)
library(dplyr)
library(disk.frame)
data(flights)
```

```{r make_df}
flights_df = as.disk.frame(
  flights, outdir = file.path(tempdir(), "tmp_flights.df"),
  overwrite = TRUE
)
```

```{r}
keep_delay = 0
flights_df %>%
  filter(dep_delay >= keep_delay) %>%
  group_by(carrier) %>%
  summarize(count = n(), mean_dep_delay = mean(dep_delay, na.rm=T)) %>%  # mean follows normal R rules
  collect %>% 
  arrange(carrier)
```